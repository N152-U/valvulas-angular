<div class="cardF">
    <p-card>
        <h4 style="text-align:center;">Registro Válvula</h4>
        <form (ngSubmit)="createValves()" #A="ngForm" [formGroup]="aFormGroup" class="needs-validation center" novalidate>
            <p-divider></p-divider>
            <div style="text-align: center;">Ubicacion de válvula</div>
            <br>
            <div class="p-fluid p-grid">

                <div class="p-field p-col-12 p-md-3">
                    <label>Alcaldía*</label>
                    <p-dropdown #ddmunicipality [options]="municipality" [style]="{ width: '100%' }" scrollHeight="400px" id="municipalityId" formControlName="municipalityId" optionLabel="municipality" [filter]="true" filterBy="municipality" name="municipalityId" [showClear]="true"
                        placeholder="Seleccione Alcaldía" (onChange)="municipalityChanged()" [class]="{
                            'is-invalid':
                            municipalityId.invalid && (municipalityId.dirty || municipalityId.touched),
                            'is-valid': municipalityId.valid
                          }">
                        <ng-template let-item pTemplate="selectedMunicipality">
                            <div class="municipality-municipality municipality-item-value" *ngIf="selectedMunicipality">
                                <div>{{ selectedMunicipality }}</div>
                            </div>
                        </ng-template>
                        <ng-template let-municipality pTemplate="municipality">
                            <div class="municipality-item">
                                <div>{{ municipality.municipality }}</div>
                            </div>
                        </ng-template>
                    </p-dropdown>
                    <div *ngIf="municipalityId.invalid && (municipalityId.dirty || municipalityId.touched)" class="invalid-feedback">
                        <div *ngIf="municipalityId.errors.required">El campo es obligatorio</div>
                    </div>
                </div>

                <div class="p-field p-col-12 p-md-3">
                    <label>Colonia*</label>
                    <p-dropdown #ddsettlements (onChange)="settlementChanged()" [style]="{ width: '100%' }" [options]="settlements" scrollHeight="400px" optionLabel="settlement" [filter]="true" filterBy="settlement" name="settlementId" [showClear]="true" placeholder="Seleccione colonia"
                        formControlName="settlementId" [class]="{
                        'is-invalid':
                        settlementId.invalid && (settlementId.dirty || settlementId.touched),
                        'is-valid': settlementId.valid
                      }">
                        <ng-template let-item pTemplate="selectedSettlement">
                            <div class="settlement-settlement municipality-item-value" *ngIf="selectedSettlement">
                                <div>{{ selectedSettlement }}</div>
                            </div>
                        </ng-template>
                        <ng-template let-settlement pTemplate="settlement">
                            <div class="settlement-item">
                                <div>{{ settlement.settlement }}</div>
                            </div>
                        </ng-template>
                    </p-dropdown>
                    <div *ngIf="settlementId.invalid && (settlementId.dirty || settlementId.touched)" class="invalid-feedback">
                        <div *ngIf="settlementId.errors.required">El campo es obligatorio</div>
                    </div>
                </div>

                <div class="p-field p-col-12 p-md-3">
                    <label for="inputtext">C.P*</label>
                    <input placeholder="Codigo Postal" autocomplete="disabled" type="text" class="form-control" id="zipcode" name="zipcode" formControlName="zipcode" pInputText [class]="{
                        'is-invalid':
                        zipcode.invalid && (zipcode.dirty || zipcode.touched),
                        'is-valid': zipcode.valid
                      }">
                    <div *ngIf="zipcode.invalid && (zipcode.dirty || zipcode.touched)" class="invalid-feedback">
                        <div *ngIf="zipcode.errors.required">El campo es obligatorio</div>
                    </div>
                </div>

                <div class="p-field p-col-12 p-md-3">
                    <label for="inputtext">Sector</label>
                    <p-dropdown #ddsector [style]="{ width: '100%'}" [options]="sectors" scrollHeight="400px" optionLabel="cve_sec" [filter]="true" filterBy="cve_sec" name="sectorId" [showClear]="true" placeholder="Seleccione el Sector" formControlName="sectorId" [class]="{
                        'is-invalid':
                        sectorId.invalid && (sectorId.dirty || sectorId.touched),
                        'is-valid': sectorId.valid
                      }">
                        <ng-template let-item pTemplate="selectedSector">
                            <div class="sectors municipality-item-value" *ngIf="selectedSector">
                                <div>{{ selectedSector }}</div>
                            </div>
                        </ng-template>
                        <ng-template let-sector pTemplate="sector">
                            <div class="sector-item">
                                <div>{{ sector.cve_sec }}</div>
                            </div>
                        </ng-template>
                    </p-dropdown>
                    <div *ngIf="zipcode.invalid && (zipcode.dirty || zipcode.touched)" class="invalid-feedback">
                        <div *ngIf="zipcode.errors.required">El campo es obligatorio</div>
                    </div>
                </div>

                <div class="p-field p-col-12 p-md-3">
                    <label for="inputtext">Calle*</label>
                    <input placeholder="Calle" type="text" id="inputtext" pInputText formControlName="street" [class]="{
                        'is-invalid':
                        street.invalid && (street.dirty || street.touched),
                        'is-valid': street.valid
                      }">
                    <div *ngIf="street.invalid && (street.dirty || street.touched)" class="invalid-feedback">
                        <div *ngIf="street.errors.required">El campo es obligatorio</div>
                    </div>
                </div>

                <div class="p-field p-col-12 p-md-3">
                    <label for="inputtext">Esquina</label>
                    <input placeholder="Esquina" type="text" id="inputtext" pInputText formControlName="corner">
                </div>

                <div class="p-field p-col-12 p-md-3">
                    <label for="inputtext">Entre Calle*</label>
                    <input placeholder="Entre Calle" type="text" id="inputtext" pInputText formControlName="btwFirstStreet" [class]="{
                        'is-invalid':
                        btwFirstStreet.invalid && (btwFirstStreet.dirty || btwFirstStreet.touched),
                        'is-valid': btwFirstStreet.valid
                      }">
                    <div *ngIf="btwFirstStreet.invalid && (btwFirstStreet.dirty || btwFirstStreet.touched)" class="invalid-feedback">
                        <div *ngIf="btwFirstStreet.errors.required">El campo es obligatorio</div>
                    </div>
                </div>

                <div class="p-field p-col-12 p-md-3">
                    <label for="inputtext">Y Calle*</label>
                    <input placeholder="Y Calle" type="text" id="inputtext" pInputText formControlName="btwSecondStreet" [class]="{
                        'is-invalid':
                        btwSecondStreet.invalid && (btwSecondStreet.dirty || btwSecondStreet.touched),
                        'is-valid': btwSecondStreet.valid
                      }">
                    <div *ngIf="btwSecondStreet.invalid && (btwSecondStreet.dirty || btwSecondStreet.touched)" class="invalid-feedback">
                        <div *ngIf="btwSecondStreet.errors.required">El campo es obligatorio</div>
                    </div>
                </div>

                <div class="p-field p-col-12 p-md-12">
                    <label for="textarea">Referencia</label>
                    <textarea placeholder="Referencia" inputId="textarea" rows="3" style="resize: none;" cols="30" pInputTextarea formControlName="reference"></textarea>
                </div>

            </div>
            <p-divider></p-divider>
            <div style="text-align: center;">Datos de la válvula</div>
            <br>
            <div class="p-fluid p-grid">

                <div class="p-field p-col-12 p-md-3">
                    <label for="dropdown">Diámetro*</label>
                    <!-- <input placeholder="Diametro" type="number" id="inputtext" maxlength="2" pInputText formControlName="diameter" [class]="{
                        'is-invalid':
                        diameterId.invalid && (diameterId.dirty || diameterId.touched),
                        'is-valid': diameterId.valid
                      }"> -->
                    <input placeholder="Diametro" maxlength="2" [pKeyFilter]="blockSpecial" id="inputtext" pInputText formControlName="diameter" [class]="{
                        'is-invalid':
                        diameterId.invalid && (diameterId.dirty || diameterId.touched),
                        'is-valid': diameterId.valid
                      }">
                    <div *ngIf="diameterId.invalid && (diameterId.dirty || diameterId.touched)" class="invalid-feedback">
                        <div *ngIf="diameterId.errors.required">El campo es obligatorio</div>
                    </div>
                </div>

                <div class="p-field p-col-12 p-md-3">
                    <label for="dropdown">Localización*</label>
                    <p-dropdown placeholder="Localización" inputId="dropdown" [options]="location" [autoDisplayFirst]="false" optionLabel="location" formControlName="valveLocationId" [showClear]="true"></p-dropdown>

                </div>

                <div class="p-field p-col-12 p-md-3">
                    <label for="dropdown">Tipo de Red*</label>
                    <p-dropdown placeholder="Tipo de Red" inputId="dropdown" [options]="road" [autoDisplayFirst]="false" optionLabel="type" formControlName="roadId" [showClear]="true"></p-dropdown>
                </div>

                <div class="p-field p-col-12 p-md-3">
                    <label for="inputtext">Tipo de Válvula*</label>
                    <input placeholder="Tipo de Válvula" type="text" id="inputtext" pInputText formControlName="valveType">
                </div>

                <div class="p-field p-col-12 p-md-3">
                    <label for="photo">Foto</label>
                    <input type="file" id="photo" (change)="onFileChange($event)" #photo pInputText>
                    <img *ngIf="imgResultAfterCompress" [src]="imgResultAfterCompress" alt="" height="60%" width="30%">
                    <!--  <input type="file" id="photo" (change)="onFileChange($event)" #photo> -->

                </div>
                <br>
            </div>
            <p-divider></p-divider>
            <div style="text-align: center;">Datos de cierre de la válvula</div>
            <br>
            <div class="p-fluid p-grid">

                <div class="p-field p-col-12 p-md-3">
                    <label for="dropdown">Dirección de Cierre*</label>
                    <p-dropdown placeholder="Dirección" [options]="directions" inputId="dropdown" [autoDisplayFirst]="false" optionLabel="name" formControlName="directionClose"></p-dropdown>
                </div>
            </div>
            <div class="d-flex justify-content-end">
                <p-button type="submit" label="Guardar" icon="pi pi-check" styleClass="p-button-sm p-button-success">
                </p-button>
                <p-button [routerLink]="['/valve/table']" label="Cancelar" icon="pi pi-times" styleClass="p-button-sm p-button-danger" [style]="{'margin-left': '.4em'}"></p-button>
            </div>
        </form>
    </p-card>
</div>